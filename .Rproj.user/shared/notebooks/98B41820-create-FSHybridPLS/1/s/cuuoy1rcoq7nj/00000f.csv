"0","#' Normalize a functional data object by its mean and standard deviation."
"0","#'"
"0","#' @param functional fd object (fda package). The functional data to be normalized (N samples)."
"0","#' @param mean_functional fd object (fda package). The mean function (1 sample)."
"0","#' @param deno Numeric scalar. The standard deviation or scaling factor."
"0","#' @return A new fd object containing the normalized functions."
"0","#' @export"
"0","curve_normalize <- function(functional, mean_functional, deno) {"
"0","  # Type checks"
"0","  stopifnot("
"0","    ""'functional' must be an 'fd' object"" = inherits(functional, ""fd""),"
"0","    ""'mean_functional' must be an 'fd' object"" = inherits(mean_functional, ""fd""),"
"0","    ""'deno' must be a single positive numeric value"" = is.numeric(deno) && length(deno) == 1 && deno > 0"
"0","  )"
"0","  "
"0","  # 1. Centering: functional - mean_functional"
"0","  # fda::minus.fd handles the broadcasting of the single-sample mean_functional."
"0","  centered_functional <- fda::minus.fd(functional, mean_functional)"
"0","  "
"0","  # 2. Scaling: (1/deno) * centered_functional"
"0","  functional_normalized <- fda::times.fd(1/deno, centered_functional)"
"0","  "
"0","  return(functional_normalized)"
"0","}"
