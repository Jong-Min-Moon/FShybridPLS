"0","#' Split Hybrid Predictor and Response Data"
"0","#'"
"0","#' Splits the hybrid predictor object and the response vector into training and"
"0","#' testing sets based on a given training ratio."
"0","#'"
"0","#' @param W_hybrid predictor_hybrid object containing all functional and scalar data."
"0","#' @param response Vector. The response variable corresponding to the samples in W_hybrid."
"0","#' @param train_ratio Numeric scalar between 0 and 1 indicating the proportion of data to use for training."
"0","#' @return List containing split train and test sets for all components."
"0","#' @export"
"0","split.all <- function(W_hybrid, response, train_ratio) {"
"0","  # --- Type and Ratio Checks ---"
"0","  stopifnot("
"0","    ""'W_hybrid' must be a predictor_hybrid object"" = inherits(W_hybrid, ""predictor_hybrid""),"
"0","    ""'response' must be a vector"" = is.vector(response),"
"0","    ""Response length must match hybrid sample size"" = length(response) == W_hybrid$n_sample,"
"0","    ""'train_ratio' must be between 0 and 1"" = is.numeric(train_ratio) && train_ratio > 0 && train_ratio < 1"
"0","  )"
"0",""
"0","  N <- W_hybrid$n_sample"
"0","  N_train <- floor(N * train_ratio)"
"0",""
"0","  # Generate random indices for training set"
"0","  # Using 1:N ensures indices are always valid"
"0","  train_idx <- sample(1:N, N_train)"
"0","  test_idx <- (1:N)[-train_idx]"
"0","  "
"0","  W_train <- predictor_hybrid("
"0","    W_hybrid$Z[train_idx, , drop = FALSE],"
"0","    list("
"0","      W_hybrid$functional_list[[1]][train_idx],"
"0","      W_hybrid$functional_list[[2]][train_idx]"
"0","    )"
"0","  )"
"0"," "
"0","  W_test <- predictor_hybrid("
"0","    W_hybrid$Z[test_idx, , drop = FALSE],"
"0","    list("
"0","      data_fun_1_test = W_hybrid$functional_list[[1]][test_idx],"
"0","    data_fun_2_test = W_hybrid$functional_list[[2]][test_idx]"
"0","    )"
"0","  )"
"0","  "
"0","  return( "
"0","    list("
"0","    predictor_train = W_train,"
"0","    predictor_test = W_test ,"
"0","    response_train = response[train_idx],"
"0","    response_test = response[test_idx]"
"0","  ))"
"0","}"
