"0","residualize_predictor <- function(W, rho, delta){"
"0","  n <- length(rho)"
"0","  W_res <- W"
"0","  for (i in 1:n){"
"0","    W_res_i <-subtr.predictor_hybrid(subset_predictor_hybrid(W, i), delta,  rho[i]) "
"0","    W_res <- replace_obs_hybrid(W_res, i, W_res_i)"
"0","  }"
"0","  return(W_res)"
"0","}"
