"0","#' Inner product between two predictor_hybrid objects (with broadcasting)"
"0","#'"
"0","#' Computes the inner product between two `predictor_hybrid` objects,"
"0","#' including both functional and scalar components. Supports broadcasting"
"0","#' when one of the inputs has a single observation."
"0","#'"
"0","#' @param xi_1 A `predictor_hybrid` object."
"0","#' @param xi_2 Another `predictor_hybrid` object. If missing, defaults to `xi_1`."
"0","#'"
"0","#' @return A numeric vector of inner products, or a scalar if both inputs contain a single observation."
"0","#' @export"
"0","inprod_pen.predictor_hybrid <- function(xi_1, xi_2 = NULL, lambda) {"
"0",""
"0","  inprod <- inprod.predictor_hybrid(xi_1, xi_2)"
"0","  # Prepare components"
"0","  "
"0","  f1 <- xi_1$functional_list"
"0",""
"0","  f2 <- xi_2$functional_list"
"0","  for (j in 1:xi_1$n_functional){"
"0","    inprod <- inprod + lambda[j] * fda::inprod("
"0","        fdobj1 = f1[[j]], "
"0","        fdobj2 = f2[[j]], "
"0","        Lfdobj1 = 2,"
"0","        Lfdobj2 = 2"
"0","        )"
"0","   "
"0","    }"
"0","  "
"0",""
"0"," "
"0",""
"0","  # Combine results"
"0","   return(as.numeric(inprod))"
"0","}"
