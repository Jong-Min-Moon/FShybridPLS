"0","#' Compute the First PLS Component from a Hybrid Predictor"
"0","#'"
"0","#' Computes the coefficients of the first Partial Least Squares (PLS) component based on "
"0","#' a hybrid predictor object and a response vector, using a regularized generalized eigenvalue problem."
"0","#'"
"0","#' @param W A predictor_hybrid object containing both functional and scalar predictors."
"0","#' @param y A numeric response vector of length equal to the number of samples in W."
"0","#' @param L cholesky decompisition of a regularization matrix (typically positive definite) used in the generalized eigenproblem."
"0","#'"
"0","#' @return A list with the following elements:"
"0","#'"
"0","#'   xi_hat: The estimated first PLS component as a predictor_hybrid object."
"0","#'   E: The generalized eigenvalue problem matrix E = inv(L) V* t(inv(L))."
"0","#'   V_star: The cross-covariance matrix between predictors and response.}"
"0","#'   eigen_val: The leading eigenvalue of E."
"0","#' "
"0","#'"
"0","#' @export"
"0","get_pls_comp <- function(W, y, L){"
"0",""
"0","  "
"0","  V_star <- get_pre_corrcov(W, y)"
"0",""
"0","  #invL <- Matrix::chol2inv(L)"
"0","  invL <- solve(L)"
"0","  A <- V_star %*% t(invL)       # A = V* × t(inv(L))"
"0","  E <- invL %*% A               # E = inv(L) × A"
"0",""
"0","  eigen_result <- eigen(E)"
"0","  e <- eigen_result$vectors[, 1]"
"0","  if (is.complex(e)){"
"0","    print(""stop"")"
"0","    return(""stop"")"
"0","  } "
"0",""
"0",""
"0","  xi_star <- t(invL) %*% e      # xi_star solves t(L) xi = e"
"0","  xi_hat <- predictor_hybrid_from_coef(format = W, coef = xi_star)"
"0","  return(xi_hat)"
"0","}"
