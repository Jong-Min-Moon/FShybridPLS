"0","#'Split Functional, Scalar, and Response Data"
"0","#' @param data_fun_1 fd object (fda package). Functional predictor 1."
"0","#' @param data_fun_2 fd object (fda package). Functional predictor 2."
"0","#' @param data_scalar Matrix. Scalar predictors."
"0","#' @param response Vector. Response variable."
"0","#' @param train_idx Vector. Indices for train data."
"0","#' @return List containing split train and test sets."
"0","#' @export"
"0","split.all <- function(data_fun_1, data_fun_2, data_scalar, response, train_idx) {"
"0","  # --- Type Checks ---"
"0","  stopifnot("
"0","    # Functional data checks (assuming 'fd' class from the 'fda' package)"
"0","    inherits(data_fun_1, ""fd""),"
"0","    inherits(data_fun_2, ""fd""),"
"0","    "
"0","    # Scalar predictor check"
"0","    is.matrix(data_scalar),"
"0","    "
"0","    # Response variable check"
"0","    is.vector(response) || is.numeric(response) || is.factor(response),"
"0","    "
"0","    # Training index check"
"0","    is.vector(train_idx),"
"0","    is.numeric(train_idx),"
"0","    all(train_idx > 0), # Indices should be positive"
"0","    all(train_idx == round(train_idx)) # Indices should be integers"
"0","  )"
"0","  # -------------------"
"0","  "
"0","  return(list("
"0","    data_fun_1_train = data_fun_1[train_idx],"
"0","    data_fun_1_test = data_fun_1[-train_idx],"
"0","    data_fun_2_train = data_fun_2[train_idx],"
"0","    data_fun_2_test = data_fun_2[-train_idx],"
"0","    data_scalar_train = data_scalar[train_idx, , drop = FALSE],"
"0","    data_scalar_test = data_scalar[-train_idx, , drop = FALSE],"
"0","    response_train = response[train_idx],"
"0","    response_test = response[-train_idx]"
"0","  ))"
"0","}"
