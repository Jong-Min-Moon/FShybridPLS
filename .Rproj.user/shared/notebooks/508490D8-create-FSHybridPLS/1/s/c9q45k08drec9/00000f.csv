"0","#' Multiply a predictor_hybrid object by a scalar"
"0","#'"
"0","#' Performs scalar multiplication on both the scalar and functional components"
"0","#' of a `predictor_hybrid` object. Functional predictors are scaled using "
"0","#' `times.fd()` from the `fda` package."
"0","#'"
"0","#' @param input A `predictor_hybrid` object."
"0","#' @param scalar A numeric value to multiply all components by."
"0","#'"
"0","#' @return A new `predictor_hybrid` object scaled by `scalar`."
"0","#' @export"
"0","scalar_mul.predictor_hybrid <- function(input, scalar) {"
"0","  if (!inherits(input, ""predictor_hybrid"")) {"
"0","    stop(""Input must be of class 'predictor_hybrid'."")"
"0","  }"
"0","  if (!is.numeric(scalar) || length(scalar) != 1) {"
"0","    stop(""Scalar must be a single numeric value."")"
"0","  }"
"0",""
"0","  # Scale functional components"
"0","  new_functional_list <- lapply(input$functional_list, function(fd_obj) {"
"0","    times.fd(scalar, fd_obj)"
"0","  })"
"0",""
"0","  # Scale scalar predictors"
"0","  new_Z <- scalar * input$Z"
"0",""
"0","  # Reconstruct hybrid object"
"0","  predictor_hybrid("
"0","    Z = new_Z,"
"0","    functional_list = new_functional_list"
"0","  )"
"0","}"
