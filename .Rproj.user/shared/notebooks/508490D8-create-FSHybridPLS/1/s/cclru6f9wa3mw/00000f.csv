"0","get_CJ <- function(W){"
"0","  n <- W$n_sample"
"0","  K <- W$n_functional"
"0","  ## C_J : C multiplied by J. Scalable to arbitrary K"
"0","  predictor_first <- W$functional_list[[1]]"
"0","  C_J <- t(predictor_first$coefs) %*% W$gram_list[[1]]"
"0","  for (i in 2:K){"
"0","    predictor_now <- W$functional_list[[i]]"
"0","    C_J <- cbind("
"0","      C_J,"
"0","      t(predictor_now$coefs) %*% W$gram_list[[i]]"
"0","    )"
"0","    }"
"0","    return(C_J)"
"0","}"
