"0","#' @export"
"0","get_pls_direction_coeff <- function(W, y, L){"
"0",""
"0","  V_star <- get_pre_corrcov(W, y)"
"0",""
"0","  #invL <- Matrix::chol2inv(L)"
"0","  invL <- solve(L)"
"0","  A <- V_star %*% t(invL)       # A = V* × t(inv(L))"
"0","  E <- invL %*% A               # E = inv(L) × A"
"0",""
"0","  eigen_result <- eigen(E)"
"0","  e <- eigen_result$vectors[, 1]"
"0","  if (is.complex(e)){"
"0","    print(""stop"")"
"0","    return(""stop"")"
"0","  } "
"0",""
"0",""
"0","  xi_star <- t(invL) %*% e      # xi_star solves t(L) xi = e"
"0","  return(xi_star)"
"0","}"
