"0","get_xi_direct <- function(W, y) {"
"0","  K <- W$n_functional"
"0","  C_J <- get_CJ(W)"
"0","  A <- cbind(C_J, W$Z)                      # shape: n Ã— d"
"0","  b <- t(y) %*% A / W$n_sample   # equivalent to V_star"
"0",""
"0","  J_star <- get_gram_matrix_block(W)"
"0","  alpha <- solve(J_star, t(b))                # unconstrained maximizer"
"0","  norm_squared <- as.numeric( t(alpha) %*% J_star %*% alpha )"
"0","  xi_hat <- alpha / sqrt(norm_squared)  # normalize"
"0",""
"0","  return(xi_hat)"
"0","}"
