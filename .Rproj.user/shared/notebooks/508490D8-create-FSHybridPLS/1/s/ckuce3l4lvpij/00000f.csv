"0","testthat::test_that(""rep_fd correctly replicates a list of fd objects"", {"
"0","  suppressPackageStartupMessages(library(fda))"
"0",""
"0","  # Create a simple basis"
"0","  basis <- create.bspline.basis(c(0, 1), 5)"
"0",""
"0","  # Create single-sample fd object"
"0","  coef_vec <- 1:5"
"0","  fd1 <- fd(coef = matrix(coef_vec, ncol = 1), basisobj = basis)"
"0",""
"0","  # Replicate the list"
"0","  rep_list <- rep_fd(list(fd1, fd1), 3)"
"0",""
"0","  # Check: list length unchanged"
"0","  testthat::expect_equal(length(rep_list), 2)"
"0",""
"0","  # Check each replicated fd object"
"0","  for (fd_obj in rep_list) {"
"0","    testthat::expect_s3_class(fd_obj, ""fd"")"
"0","    testthat::expect_equal(dim(fd_obj$coefs), c(5, 3))  # 5 basis Ã— 3 samples"
"0","    for (i in 1:3) {"
"0","      testthat::expect_equal(fd_obj$coefs[, i], coef_vec)"
"0","    }"
"0","  }"
"0",""
"0","  # Error if not single-sample"
"0","  fd_multi <- fd(coef = matrix(1:10, nrow = 5, ncol = 2), basisobj = basis)"
"0","  testthat::expect_error(rep_fd(list(fd_multi)), ""Each fd object in the list must have one column"")"
"0","  "
"0","  # Error on non-fd input"
"0","  testthat::expect_error(rep_fd(list(1, ""not_fd"")), ""Input must be a list of 'fd' objects"")"
"0","})"
"1","[32mTest passed[39m ğŸŠ
"
