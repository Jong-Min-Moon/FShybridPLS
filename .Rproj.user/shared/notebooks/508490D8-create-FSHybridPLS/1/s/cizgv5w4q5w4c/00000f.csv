"0","#' Construct the roughness penalty matrix for a predictor_hybrid object"
"0","#'"
"0","#' Returns a block diagonal matrix representing roughness penalties for each functional predictor"
"0","#' and zeros for the scalar predictors (scalar predictors are not penalized). Each functional component uses its own basis penalty matrix, computed via second derivative penalty via `getbasispenalty()` from the `fda` package"
"0","#'"
"0","#' @param W A `predictor_hybrid` object."
"0","#'"
"0","#' @return A block diagonal penalty matrix of dimension `(sum(n_basis_list) + n_scalar)^2`."
"0","#' @export"
"0","get_penalty_hybrid <- function(W){"
"0","  J_dotdot_star <- fda::getbasispenalty(W$functional_list[[1]]$basis)"
"0","  for (ii in 2:(W$n_functional)){"
"0","    J_dotdot_star <- Matrix::bdiag("
"0","      J_dotdot_star,"
"0","      fda::getbasispenalty(W$functional_list[[ii]]$basis)"
"0","    )"
"0","    }"
"0","  J_dotdot_star <- Matrix::bdiag("
"0","    J_dotdot_star,"
"0","    matrix(0, nrow = W$n_scalar, ncol = W$n_scalar)"
"0","    )"
"0","  return(J_dotdot_star)"
"0","  }"
