"0","testthat::test_that(""Gram matrix edge cases"", {"
"0","  suppressPackageStartupMessages(library(fda))"
"0",""
"0","  # Case 1: Fourier basis (orthogonal over [0, 1])"
"0","  fb <- create.fourier.basis(rangeval = c(0, 1), nbasis = 5)"
"0","  J_fourier <- compute_gram_matrix(fb)"
"0","  testthat::expect_equal(J_fourier, diag(diag(J_fourier)), tolerance = 1e-10)  # Nearly diagonal"
"0",""
"0","  # Case 2: Constant basis (1 basis function)"
"0","  cb <- create.constant.basis(rangeval = c(0, 1))"
"0","  J_const <- compute_gram_matrix(cb)"
"0","  testthat::expect_equal(dim(J_const), c(1, 1))"
"0","  testthat::expect_equal(J_const[1, 1], 1)"
"0",""
"0","  # Case 3: Invalid input"
"0","  testthat::expect_error(compute_gram_matrix(""not a basisfd""))"
"0",""
"0","  # Case 4: Highly localized B-splines"
"0","  # Simulate nearly disjoint support (narrow B-splines)"
"0","  narrow_bs <- create.bspline.basis(rangeval = c(0, 1), nbasis = 10, norder = 2)"
"0","  J_narrow <- compute_gram_matrix(narrow_bs)"
"0","  testthat::expect_true(all(abs(J_narrow[upper.tri(J_narrow)]) < 0.5))  # off-diagonals small"
"0","})"
"1","[32mTest passed[39m ðŸŽŠ
"
