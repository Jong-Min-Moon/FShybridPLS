"0","#' Replicate a list of single-sample fd objects multiple times"
"0","#'"
"0","#' This function broadcasts a list of single-sample functional predictors"
"0","#' by replicating their coefficient columns."
"0","#'"
"0","#' @param fd_list A list of `fd` objects, each representing a single sample."
"0","#' @param n The number of replications desired."
"0","#'"
"0","#' @return A list of `fd` objects, each with `n` replications."
"0","#' @export"
"0","rep_fd <- function(fd_list, n) {"
"0","  if (!is.list(fd_list) || any(!vapply(fd_list, inherits, logical(1), ""fd""))) {"
"0","    stop(""Input must be a list of 'fd' objects."")"
"0","  }"
"0",""
"0","  lapply(fd_list, function(fd_obj) {"
"0","    coef_mat <- fd_obj$coefs"
"0","    if (is.null(dim(coef_mat)) || ncol(coef_mat) != 1) {"
"0","      stop(""Each fd object in the list must have one column of coefficients."")"
"0","    }"
"0",""
"0","    new_coefs <- matrix(rep(coef_mat, n), nrow = nrow(coef_mat), ncol = n)"
"0","    fd(coef = new_coefs, basisobj = fd_obj$basis)"
"0","  })"
"0","}"
