rmarkdown::draft("create-rhello.Rmd", template = "make-an-r-package", package = "litr")
#' Constructor for predictor_hybrid S4 Class
#'
#' Creates an object of class \code{predictor_hybrid}, which stores both scalar and functional predictors,
#' along with Jacobians and associated metadata.
#'
#' @param Z A numeric matrix of dimension \code{n_sample × n_scalar} representing scalar predictors.
#' @param functional_list A list of functional predictors (e.g., \code{fd} objects from the \code{fda} package).
#' @param jacobian_list A list of Jacobian matrices corresponding to the functional predictors.
#' @param n_basis_list A numeric vector indicating the number of basis functions for each functional predictor.
#' @param n_sample Number of observations (samples).
#' @param n_functional Number of functional predictors.
#' @param n_scalar Number of scalar predictors.
#'
#' @return An object of S4 class \code{predictor_hybrid}.
#' @export
predictor_hybrid <- function(Z, functional_list, jacobian_list,
n_basis_list, n_sample, n_functional, n_scalar) {
new("predictor_hybrid",
Z = Z,
functional_list = functional_list,
jacobian_list = jacobian_list,
n_basis_list = n_basis_list,
n_sample = n_sample,
n_functional = n_functional,
n_scalar = n_scalar)
}
testthat::test_that("predictor_hybrid constructor works as expected", {
# Simulate scalar predictor matrix
Z <- matrix(rnorm(100 * 5), nrow = 100, ncol = 5)
# Placeholder functional components
fd1 <- list(fdobj = "fd1 placeholder")
fd2 <- list(fdobj = "fd2 placeholder")
# Placeholder Jacobians
J1 <- matrix(runif(100), nrow = 10)
J2 <- matrix(runif(200), nrow = 20)
# Construct object
obj <- new("predictor_hybrid",
Z = Z,
functional_list = list(fd1, fd2),
jacobian_list = list(J1, J2),
n_basis_list = c(10, 20),
n_sample = 100,
n_functional = 2,
n_scalar = 5)
# Assertions
testthat::expect_s4_class(obj, "predictor_hybrid")
testthat::expect_equal(nrow(obj@Z), 100)
testthat::expect_equal(ncol(obj@Z), 5)
testthat::expect_equal(length(obj@functional_list), 2)
testthat::expect_equal(length(obj@jacobian_list), 2)
testthat::expect_equal(obj@n_basis_list, c(10, 20))
testthat::expect_equal(obj@n_sample, 100)
testthat::expect_equal(obj@n_functional, 2)
testthat::expect_equal(obj@n_scalar, 5)
})
#' @param Z A numeric matrix of dimension \code{n_sample × n_scalar} representing scalar predictors.
#' @param functional_list A list of functional predictors (\code{fd} objects from the \code{fda} package).
#' @param jacobian_list A list of Jacobian matrices corresponding to the functional predictors.
#' @param n_basis_list A numeric vector indicating the number of basis functions for each functional predictor.
#' @param n_sample Number of observations (samples).
#' @param n_functional Number of functional predictors.
#' @param n_scalar Number of scalar predictors.
#'
#' @return An object of S4 class \code{predictor_hybrid}.
#' @export
setClass(
"predictor_hybrid",
representation(
Z = "matrix",
functional_list = "list",
jacobian_list = "list",
n_basis_list = "numeric",
# Basic metadata:
n_sample = "numeric",
n_functional = "numeric",
n_scalar = "numeric"
)
)
#' Constructor for predictor_hybrid S4 Class
#'
#' Creates an object of class \code{predictor_hybrid}, which stores both scalar and functional predictors,
#' along with Jacobians and associated metadata.
#'
#' @param Z A numeric matrix of dimension \code{n_sample × n_scalar} representing scalar predictors.
#' @param functional_list A list of functional predictors (e.g., \code{fd} objects from the \code{fda} package).
#' @param jacobian_list A list of Jacobian matrices corresponding to the functional predictors.
#' @param n_basis_list A numeric vector indicating the number of basis functions for each functional predictor.
#' @param n_sample Number of observations (samples).
#' @param n_functional Number of functional predictors.
#' @param n_scalar Number of scalar predictors.
#'
#' @return An object of S4 class \code{predictor_hybrid}.
#' @export
predictor_hybrid <- function(Z, functional_list, jacobian_list,
n_basis_list, n_sample, n_functional, n_scalar) {
new("predictor_hybrid",
Z = Z,
functional_list = functional_list,
jacobian_list = jacobian_list,
n_basis_list = n_basis_list,
n_sample = n_sample,
n_functional = n_functional,
n_scalar = n_scalar)
}
testthat::test_that("predictor_hybrid constructor works as expected", {
# Simulate scalar predictor matrix
Z <- matrix(rnorm(100 * 5), nrow = 100, ncol = 5)
# Placeholder functional components
fd1 <- list(fdobj = "fd1 placeholder")
fd2 <- list(fdobj = "fd2 placeholder")
# Placeholder Jacobians
J1 <- matrix(runif(100), nrow = 10)
J2 <- matrix(runif(200), nrow = 20)
# Construct object
obj <- new("predictor_hybrid",
Z = Z,
functional_list = list(fd1, fd2),
jacobian_list = list(J1, J2),
n_basis_list = c(10, 20),
n_sample = 100,
n_functional = 2,
n_scalar = 5)
# Assertions
testthat::expect_s4_class(obj, "predictor_hybrid")
testthat::expect_equal(nrow(obj@Z), 100)
testthat::expect_equal(ncol(obj@Z), 5)
testthat::expect_equal(length(obj@functional_list), 2)
testthat::expect_equal(length(obj@jacobian_list), 2)
testthat::expect_equal(obj@n_basis_list, c(10, 20))
testthat::expect_equal(obj@n_sample, 100)
testthat::expect_equal(obj@n_functional, 2)
testthat::expect_equal(obj@n_scalar, 5)
})
library(methods)
