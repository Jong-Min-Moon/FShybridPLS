% Generated by roxygen2: do not edit by hand
% Please edit documentation in create-FSHybridPLS.Rmd.
\name{fit_pfr}
\alias{fit_pfr}
\title{Fit Penalized Functional Regression (PFR)}
\usage{
fit_pfr(W_train, y_train, W_test, y_test)
}
\arguments{
\item{W_train}{A list containing training predictors:
\itemize{
\item \code{Z}: Matrix of scalar predictors.
\item \code{functional_list}: List of \code{fd} objects (functional predictors).
\item \code{eval_point}: Vector of evaluation time points.
}}

\item{y_train}{Vector of scalar response values for training.}

\item{W_test}{A list containing testing predictors (same structure as \code{W_train}).}

\item{y_test}{Vector of scalar response values for testing (used for RMSE calculation).}
}
\value{
A numeric value representing the Root Mean Squared Error (RMSE) on the test set.
Returns \code{NA} if the model fit fails.
}
\description{
This function formats training and testing data, fits a PFR model using the \code{refund} package,
and evaluates predictive performance via RMSE. It explicitly handles the "unrolling" of
scalar matrix predictors to avoid common dimension errors in \code{gam}/\code{pfr}.
}