% Generated by roxygen2: do not edit by hand
% Please edit documentation in create-FSHybridPLS.Rmd.
\name{calcMFPCA}
\alias{calcMFPCA}
\title{Internal Calculation of MFPCA}
\usage{
calcMFPCA(
  N,
  p,
  Bchol,
  M,
  type,
  weights,
  npc,
  argvals,
  uniBasis,
  fit = FALSE,
  approx.eigen = FALSE
)
}
\arguments{
\item{N}{Number of observations.}

\item{p}{Number of functional elements.}

\item{Bchol}{Cholesky decomposition of the basis integral matrix (or NULL if orthogonal).}

\item{M}{Number of multivariate components to calculate.}

\item{type}{Vector of character strings specifying the univariate expansion types.}

\item{weights}{Vector of weights for each functional element.}

\item{npc}{Vector containing the number of univariate basis functions for each element.}

\item{argvals}{List of argument values.}

\item{uniBasis}{List containing the univariate basis decompositions.}

\item{fit}{Logical. If TRUE, computes the fitted values (reconstruction).}

\item{approx.eigen}{Logical. If TRUE, uses approximate eigen decomposition.}
}
\value{
A list containing eigenvalues, eigenfunctions, scores, vectors, and normalization factors.
}
\description{
Implements the core MFPCA algorithm. It combines the univariate scores from
each functional element, applies weights, and performs PCA on the weighted
concatenated scores to extract the multivariate functional principal components.
}