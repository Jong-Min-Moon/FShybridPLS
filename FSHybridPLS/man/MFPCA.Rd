% Generated by roxygen2: do not edit by hand
% Please edit documentation in create-FSHybridPLS.Rmd.
\name{MFPCA}
\alias{MFPCA}
\title{Multivariate Functional Principal Component Analysis (Modified)}
\usage{
MFPCA(
  mFData,
  mFData_predict,
  M,
  uniExpansions,
  weights = rep(1, length(mFData)),
  fit = FALSE,
  approx.eigen = FALSE,
  bootstrap = FALSE,
  nBootstrap = NULL,
  bootstrapAlpha = 0.05,
  bootstrapStrat = NULL,
  verbose = options()$verbose
)
}
\arguments{
\item{mFData}{A \code{multiFunData} object containing the training functional data.}

\item{mFData_predict}{A \code{multiFunData} object containing the test/validation functional data.}

\item{M}{Integer. The number of multivariate functional principal components to calculate.}

\item{uniExpansions}{A list of the same length as \code{mFData}, specifying the univariate basis expansion method for each element (e.g., "uFPCA").}

\item{weights}{Numeric vector. Weights for each functional element (defaults to 1).}

\item{fit}{Logical. If \code{TRUE}, returns the truncated Karhunen-Lo√®ve representation.}

\item{approx.eigen}{Logical. If \code{TRUE}, uses \code{irlba} for approximate singular value decomposition (faster for large M).}

\item{bootstrap}{Logical. If \code{TRUE}, computes bootstrap confidence bands.}

\item{nBootstrap}{Integer. Number of bootstrap iterations (required if \code{bootstrap = TRUE}).}

\item{bootstrapAlpha}{Numeric. Significance level for bootstrap confidence bands.}

\item{bootstrapStrat}{Factor. Stratification factor for bootstrapping.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages.}
}
\value{
An object of class \code{MFPCAfit} containing:
\item{values}{Eigenvalues of the principal components.}
\item{functions}{The estimated multivariate functional principal component functions.}
\item{scores}{A matrix of scores for the \code{mFData} (training) objects.}
\item{scores.pred}{A matrix of scores for the \code{mFData_predict} (test) objects.}
\item{vectors}{The eigenvectors associated with the combined scores.}
\item{normFactors}{Normalization factors used during calculation.}
\item{meanFunction}{The estimated mean function.}
}
\description{
Computes Multivariate Functional Principal Component Analysis (MFPCA) for functions
defined on different domains.

\strong{Modification:} This version has been modified to accept an additional input,
\code{mFData_predict}. This allows the function to calculate PCA scores for both
the training data and a test/validation set simultaneously. This bypasses the
limitation of the standard \code{predict.MFPCAfit} function, which often does not
support out-of-sample prediction for this specific implementation.

The function utilizes univariate basis expansions for each functional element
and combines them via PCA on the weighted concatenated scores.
}